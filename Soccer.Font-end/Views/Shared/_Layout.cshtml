@* @using Soccer.Font_end.Helpers
<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="content-type" content="text/html" charset=" utf-8" />
    <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
    <title>@ViewData["Title"] - Soccer</title>
    <link rel="shortcut icon" href=~/favicon.ico>
    <link rel=stylesheet href=~/vendor.css>
    <link rel=stylesheet href=~/style.css>
    <link rel="stylesheet" href="~/css/layerslider.css" />
    <script src=~/js/vendor/modernizr.js></script>
    <style>
        /* CSS cho dropdown user account */
        .user-account-dropdown {
            position: relative;
            display: inline-block;
        }

        .user-account-toggle {
            display: flex;
            align-items: center;
            padding: 8px 12px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            text-decoration: none;
            border-radius: 25px;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
            cursor: pointer;
            border: none;
            box-shadow: 0 2px 10px rgba(102, 126, 234, 0.3);
        }

            .user-account-toggle:hover {
                background: linear-gradient(135deg, #5a67d8 0%, #6b46c1 100%);
                transform: translateY(-1px);
                box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
                color: white;
                text-decoration: none;
            }

        .user-avatar {
            width: 24px;
            height: 24px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 8px;
            font-size: 12px;
            font-weight: bold;
        }

        .dropdown-arrow {
            margin-left: 8px;
            font-size: 10px;
            transition: transform 0.3s ease;
        }

        .user-account-dropdown.active .dropdown-arrow {
            transform: rotate(180deg);
        }

        .user-dropdown-menu {
            position: absolute;
            top: calc(100% + 8px);
            right: 0;
            background: white;
            border-radius: 12px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.15);
            min-width: 200px;
            z-index: 9999;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.3s ease;
            border: 1px solid rgba(0, 0, 0, 0.1);
        }

        .user-account-dropdown.active .user-dropdown-menu {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .user-dropdown-menu::before {
            content: '';
            position: absolute;
            top: -8px;
            right: 20px;
            width: 0;
            height: 0;
            border-left: 8px solid transparent;
            border-right: 8px solid transparent;
            border-bottom: 8px solid white;
        }

        .user-dropdown-header {
            padding: 15px;
            border-bottom: 1px solid #f0f0f0;
            text-align: center;
        }

            .user-dropdown-header .user-name {
                font-weight: bold;
                color: #333;
                font-size: 16px;
            }

            .user-dropdown-header .user-role {
                color: #666;
                font-size: 12px;
                margin-top: 2px;
            }

        .user-dropdown-menu ul {
            list-style: none;
            padding: 8px 0;
            margin: 0;
        }

        .user-dropdown-menu li {
            margin: 0;
        }

        .user-dropdown-menu a {
            display: flex;
            align-items: center;
            padding: 12px 20px;
            color: #333 !important;
            text-decoration: none;
            font-size: 14px;
            transition: all 0.2s ease;
        }

            .user-dropdown-menu a:hover {
                background: #f8f9ff;
                color: #667eea !important;
                text-decoration: none;
            }

        .user-dropdown-menu i {
            width: 18px;
            margin-right: 12px;
            font-size: 14px;
        }

        .logout-link {
            border-top: 1px solid #f0f0f0;
        }

            .logout-link a {
                color: #e53e3e !important;
            }

                .logout-link a:hover {
                    background: #fff5f5;
                    color: #c53030 !important;
                }

        /* Responsive */
        @@media (max-width: 768px) {
            .user-account-toggle {
                padding: 6px 10px;
                font-size: 12px;
            }

            .user-dropdown-menu {
                min-width: 180px;
                right: -10px;
            }
        }
    </style>
</head>
<body>
    <div class=wrapper>
        <header class=header-main>
            <div class=header-upper>
                <div class=container>
                    <div class=row>
                        <ul>
                            @{
                                var isLoggedIn = !string.IsNullOrEmpty(Context.Session.GetString("JwtToken"));
                                var userName = Context.Session.GetString("UserName");
                            }
                            @if (!isLoggedIn)
                            {
                                <li><a asp-action="Login" asp-controller="Auth">Đăng nhập</a></li>
                                <li><a asp-action="Register" asp-controller="Auth">Đăng ký</a></li>
                            }
                            <li style="position: relative;">
                                <a href="#" id="toggleCart">
                                    <i class="fa fa-shopping-cart"></i>
                                    <span>
                                        Giỏ hàng(<span class="cartitems">0</span>)
                                    </span>
                                </a>
                                <!-- VÙNG HIỂN THỊ GIỎ HÀNG -->
                                <div id="cartDropdown" style="display: none; position: absolute; right: 0;
                                top: 100%; background: white; border: 1px solid #ccc;
                                width: 200px; max-height: 400px; overflow-y: auto; z-index: 9999; padding: 10px;">
                                    <strong>Sản phẩm trong giỏ:</strong>
                                    <ul id="cartItemsList" style="list-style: none; padding-left: 0;"></ul>
                                    <hr />
                                </div>
                            </li>
                            <li>
                                <a href=shopcart.html>
                                    <i class="fa fa-heart"></i>
                                    <span>
                                        Yêu thích(<span class=cartitems>0</span>)
                                    </span>
                                </a>
                            </li>
                            @if (isLoggedIn)
                            {
                                <li style="margin-left: 20px;">
                                    <div class="user-account-dropdown" id="userAccountDropdown">
                                        <button class="user-account-toggle" id="userAccountToggle">
                                            <div class="user-avatar">
                                                @(userName?.Substring(0, 1).ToUpper() ?? "U")
                                            </div>
                                            <span>Xin chào, @userName</span>
                                            <span class="dropdown-arrow">▼</span>
                                        </button>
                                        <div class="user-dropdown-menu">
                                            <div class="user-dropdown-header">
                                                <div class="user-name">@userName</div>
                                                <div class="user-role">Thành viên</div>
                                            </div>
                                            <ul>
                                                <li>
                                                    <a href="#">
                                                        <i class="fa fa-user"></i>
                                                        Xem thông tin tài khoản
                                                    </a>
                                                </li>
                                                <li class="logout-link">
                                                    <a asp-action="Logout" asp-controller="Auth">
                                                        <i class="fa fa-sign-out"></i>
                                                        Đăng xuất
                                                    </a>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </li>
                            }
                        </ul>
                    </div>
                </div>
            </div>
            <div class="header-lower clearfix">
                <div class=container>
                    <div class=row>
                        <h1 class=logo><a href="/"><img src=~/images/logo.png alt=image></a></h1>
                        <div class=menubar>
                            <nav class=navbar>
                                <div class=nav-wrapper>
                                    <div class=navbar-header>
                                        <button type=button class=navbar-toggle>
                                            <span class=sr-only>Toggle navigation</span>
                                            <span class=icon-bar></span>
                                        </button>
                                    </div>
                                    <div class=nav-menu>
                                        <ul class="nav navbar-nav menu-bar">
                                            <li>
                                                <a href="/" class="@Html.IsActive("Home", "Index")">
                                                    Trang chủ <span></span> <span></span>
                                                    <span></span> <span></span>
                                                </a>
                                            </li>
                                            <li>
                                                <a asp-action="Index" asp-controller="About" class="@Html.IsActive("About", "Index")">
                                                    Chúng tôi <span></span> <span></span> <span></span>
                                                    <span></span>
                                                </a>
                                            </li>
                                            <li>
                                                <a asp-action="Index" asp-controller="Book" class="@Html.IsActiveParent("Book")">
                                                    Đặt sân <span></span> <span></span>
                                                    <span></span> <span></span>
                                                </a>
                                            </li>
                                            <li>
                                                <a asp-action="Index" asp-controller="Shop" class="@Html.IsActiveParent("Shop")">
                                                    Cửa hàng <span></span> <span></span> <span></span>
                                                    <span></span>
                                                </a>
                                            </li>
                                            <li>
                                                <a asp-action="Index" asp-controller="Contact" class="@Html.IsActive("Contact", "Index")">
                                                    Liên hệ <span></span> <span></span> <span></span>
                                                    <span></span>
                                                </a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </nav>
                        </div>
                    </div>
                </div>
            </div>
        </header>
        @RenderBody()
        <footer class=footer-type01>
            <div class=container>
                <div class=row>
                    <ul class=footer-widget style="margin-right: 50px;">
                        <li class=widget-about style="width:320px">
                            <h4 class=footerheading>về <span>soccer club</span></h4>
                            <p>
                                Là một website về bóng đá, cung cấp dịch vụ đặt sân, tìm đối thủ,
                                bán thiết bị thể thao chất lượng cao. Kết nối cộng đồng yêu bóng đá và tạo ra
                                những trận đấu đáng nhớ.
                            </p>
                            <p>
                                <span class=uppercaseheading>địa chỉ:</span> Khu Công nghệ cao Hòa Lạc,
                                Thạch Thất, Hà Nội
                            </p>
                            <p><span class=uppercaseheading>hotline:</span> <span class=red>0378313640</span></p>
                            <p><span class=uppercaseheading>email:</span> <span class=red>notifi.contact@gmail.com</span></p>
                        </li>

                        <li class=widget-news style="width:290px">
                            <h4 class=footerheading>dịch vụ <span>đặt sân</span></h4>
                            <ul class=widget_productdetails>
                                <li><a href="#">Sân 7 người</a></li>
                            </ul>
                        </li>

                        <li class=widget-product>
                            <h4 class=footerheading>Đặt Sân Thể Thao & <span>Mua Sắm</span></h4>
                            <ul class=widget_productdetails>
                                <li>
                                    <a asp-action="Index" asp-controller="Book" class="@Html.IsActiveParent("Book")">
                                        Đặt sân
                                    </a>
                                </li>
                                <li>
                                    <a asp-action="Index" asp-controller="Shop" class="@Html.IsActiveParent("Shop")">
                                        Cửa hàng
                                    </a>
                                </li>
                            </ul>
                        </li>
                    </ul>

                    <!-- Thêm phần mạng xã hội và thông tin bổ sung -->
                    <div class="footer-bottom">
                        <div class="social-links">
                            <h5>Kết nối với chúng tôi 
                            <a href="https://www.facebook.com/profile.php?id=61576849465856" target="_blank"><i class="fa fa-facebook"></i></a>
                            </h5>
                        </div>
                        <div class="quick-info">
                            <p><strong>Giờ hoạt động:</strong> 6:00 - 22:00 hàng ngày</p>
                            <p><strong>Hỗ trợ 24/7:</strong> Chat online hoặc gọi hotline</p>
                        </div>
                    </div>
                </div>
            </div>
        </footer>
    </div>
    <script src=~/js/vendor/vendor.js></script>
    <script src=~/js/main.js></script>
    @await RenderSectionAsync("Scripts", required: false)
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            // Xử lý dropdown giỏ hàng
            const toggleCart = document.getElementById('toggleCart');
            const dropdown = document.getElementById('cartDropdown');

            function updateCart() {
                fetch('https://api.soccer.soccertips.org/api/cart/checkout', {
                    method: 'GET',
                    credentials: 'include'
                })
                .then(res => {
                    console.log('Trạng thái phản hồi:', res.status);
                    if (!res.ok) throw new Error(`Lỗi HTTP: ${res.status}`);
                    return res.json();
                })
                .then(data => {
                    console.log('Dữ liệu giỏ hàng:', data);
                    const cartCount = data.reduce((total, item) => total + (item.quantity || 0), 0);
                    document.querySelectorAll('.cartitems').forEach(el => {
                        el.textContent = cartCount;
                    });

                    const list = document.getElementById('cartItemsList');
                    list.innerHTML = '';
                    if (data.length === 0) {
                        list.innerHTML = '<li>Không có sản phẩm nào trong giỏ.</li>';
                    } else {
                        let totalCartPrice = 0;

                        data.forEach(item => {
                            const productName = item.productName || 'Sản phẩm ID: ' + (item.productId || 'N/A');
                            const quantity = item.quantity || 0;
                            const unitPrice = item.unitPrice || 0;
                            const imageUrl = item.imageUrl || '';

                            const totalPrice = unitPrice * quantity;
                            totalCartPrice += totalPrice;

                            const li = document.createElement('li');

                            li.innerHTML = `
                                <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                    ${imageUrl ? `<img src="${imageUrl}" alt="${productName}" style="width: 40px; height: 40px; object-fit: cover;" />` : ''}
                                    <div style="flex: 1;">
                                        <span>${productName}</span>
                                        <div>Số lượng: ${quantity}</div>
                                        <div>Giá tổng: ${totalPrice.toLocaleString('vi-VN')}đ</div>
                                    </div>
                                </div>`;

                            list.appendChild(li);
                        });

                        const totalLi = document.createElement('li');
                        totalLi.innerHTML = `<strong>Tổng giá giỏ hàng: ${totalCartPrice.toLocaleString('vi-VN')}đ</strong>
                                    <a href="/Cart/Checkout" class="btn btn-primary btn-sm">Xem chi tiết</a>`;
                        list.appendChild(totalLi);
                    }
                })
                .catch(err => {
                    console.error("Lỗi lấy giỏ hàng:", err);
                    document.getElementById('cartItemsList').innerHTML = '<li>Lỗi khi tải giỏ hàng.</li>';
                });
            }

            if (toggleCart) {
                toggleCart.addEventListener('click', function (e) {
                    e.preventDefault();
                    const visible = dropdown.style.display === 'block';
                    dropdown.style.display = visible ? 'none' : 'block';
                    if (!visible) updateCart();
                });
            }

            // Xử lý dropdown user account
            const userAccountDropdown = document.getElementById('userAccountDropdown');
            const userAccountToggle = document.getElementById('userAccountToggle');

            if (userAccountToggle) {
                userAccountToggle.addEventListener('click', function (e) {
                    e.preventDefault();
                    userAccountDropdown.classList.toggle('active');
                });
            }

            // Đóng dropdown khi click bên ngoài
            document.addEventListener('click', function (e) {
                // Đóng dropdown giỏ hàng
                if (toggleCart && !toggleCart.contains(e.target) && !dropdown.contains(e.target)) {
                    dropdown.style.display = 'none';
                }

                // Đóng dropdown user account
                if (userAccountDropdown && !userAccountDropdown.contains(e.target)) {
                    userAccountDropdown.classList.remove('active');
                }
            });

            updateCart();
        });
    </script>
</body>
</html> *@

                @using Soccer.Font_end.Helpers
<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="content-type" content="text/html" charset=" utf-8" />
    <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
    <title>@ViewData["Title"] - Soccer</title>
    <link rel="shortcut icon" href=~/favicon.ico>
    <link rel=stylesheet href=~/vendor.css>
    <link rel=stylesheet href=~/style.css>
    <link rel="stylesheet" href="~/css/layerslider.css" />
    <script src=~/js/vendor/modernizr.js></script>
    <style>
        /* CSS cho dropdown user account */
        .user-account-dropdown {
            position: relative;
            display: inline-block;
        }

        .user-account-toggle {
            display: flex;
            align-items: center;
            padding: 8px 12px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            text-decoration: none;
            border-radius: 25px;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
            cursor: pointer;
            border: none;
            box-shadow: 0 2px 10px rgba(102, 126, 234, 0.3);
        }

            .user-account-toggle:hover {
                background: linear-gradient(135deg, #5a67d8 0%, #6b46c1 100%);
                transform: translateY(-1px);
                box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
                color: white;
                text-decoration: none;
            }

        .user-avatar {
            width: 24px;
            height: 24px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 8px;
            font-size: 12px;
            font-weight: bold;
        }

        .dropdown-arrow {
            margin-left: 8px;
            font-size: 10px;
            transition: transform 0.3s ease;
        }

        .user-account-dropdown.active .dropdown-arrow {
            transform: rotate(180deg);
        }

        .user-dropdown-menu {
            position: absolute;
            top: calc(100% + 8px);
            right: 0;
            background: white;
            border-radius: 12px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.15);
            min-width: 200px;
            z-index: 9999;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.3s ease;
            border: 1px solid rgba(0, 0, 0, 0.1);
        }

        .user-account-dropdown.active .user-dropdown-menu {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .user-dropdown-menu::before {
            content: '';
            position: absolute;
            top: -8px;
            right: 20px;
            width: 0;
            height: 0;
            border-left: 8px solid transparent;
            border-right: 8px solid transparent;
            border-bottom: 8px solid white;
        }

        .user-dropdown-header {
            padding: 15px;
            border-bottom: 1px solid #f0f0f0;
            text-align: center;
        }

            .user-dropdown-header .user-name {
                font-weight: bold;
                color: #333;
                font-size: 16px;
            }

            .user-dropdown-header .user-role {
                color: #666;
                font-size: 12px;
                margin-top: 2px;
            }

        .user-dropdown-menu ul {
            list-style: none;
            padding: 8px 0;
            margin: 0;
        }

        .user-dropdown-menu li {
            margin: 0;
        }

        .user-dropdown-menu a {
            display: flex;
            align-items: center;
            padding: 12px 20px;
            color: #333 !important;
            text-decoration: none;
            font-size: 14px;
            transition: all 0.2s ease;
        }

            .user-dropdown-menu a:hover {
                background: #f8f9ff;
                color: #667eea !important;
                text-decoration: none;
            }

        .user-dropdown-menu i {
            width: 18px;
            margin-right: 12px;
            font-size: 14px;
        }

        .logout-link {
            border-top: 1px solid #f0f0f0;
        }

            .logout-link a {
                color: #e53e3e !important;
            }

                .logout-link a:hover {
                    background: #fff5f5;
                    color: #c53030 !important;
                }

        /* Responsive */
        @@media (max-width: 768px) {
            .user-account-toggle {
                padding: 6px 10px;
                font-size: 12px;
            }

            .user-dropdown-menu {
                min-width: 180px;
                right: -10px;
            }
        }

        /* Animation cho logout */
        .logout-animation {
            position: relative;
            overflow: hidden;
        }

            .logout-animation::before {
                content: '';
                position: absolute;
                top: 50%;
                left: 50%;
                width: 0;
                height: 0;
                background: radial-gradient(circle, rgba(231, 76, 60, 0.3) 0%, transparent 70%);
                border-radius: 50%;
                transform: translate(-50%, -50%);
                transition: all 0.6s ease;
                z-index: 1;
            }

            .logout-animation.active::before {
                width: 300px;
                height: 300px;
            }

        /* Animation cho button logout */
        .logout-button-animate {
            transform: scale(1);
            transition: all 0.3s ease;
        }

            .logout-button-animate:hover {
                transform: scale(1.05);
                box-shadow: 0 4px 20px rgba(231, 76, 60, 0.3);
            }

            .logout-button-animate.clicked {
                transform: scale(0.95);
                animation: logoutPulse 0.6s ease;
            }

        @@keyframes logoutPulse {
            0% {
                transform: scale(0.95);
            }

            50% {
                transform: scale(1.1);
            }

            100% {
                transform: scale(0.95);
            }
        }

        /* Animation cho dropdown khi đóng */
        .user-dropdown-menu.closing {
            animation: fadeOutUp 0.3s ease forwards;
        }

        @@keyframes fadeOutUp {
            0% {
                opacity: 1;
                transform: translateY(0);
            }

            100% {
                opacity: 0;
                transform: translateY(-10px);
                visibility: hidden;
            }
        }

        /* Loading spinner cho logout */
        .logout-loading {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 0.8s linear infinite;
            margin-left: 8px;
        }

        @@keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        /* Success animation */
        .logout-success {
            animation: successBounce 0.5s ease;
        }

        @@keyframes successBounce {
            0%, 20%, 50%, 80%, 100% {
                transform: translateY(0);
            }

            40% {
                transform: translateY(-10px);
            }

            60% {
                transform: translateY(-5px);
            }
        }

        /* Fade out animation cho toàn bộ dropdown */
        .user-account-dropdown.logout-fade {
            animation: fadeOutScale 0.8s ease forwards;
        }

        @@keyframes fadeOutScale {
            0% {
                opacity: 1;
                transform: scale(1);
            }

            50% {
                opacity: 0.5;
                transform: scale(1.05);
            }

            100% {
                opacity: 0;
                transform: scale(0.9);
            }
        }
    </style>
</head>
<body>
    <div class=wrapper>
        <header class=header-main>
            <div class=header-upper>
                <div class=container>
                    <div class=row>
                        <ul>
                            <li id="authLinks"></li>
                            <li style="position: relative;">
                                <a href="#" id="toggleCart">
                                    <i class="fa fa-shopping-cart"></i>
                                    <span>
                                        Giỏ hàng(<span class="cartitems">0</span>)
                                    </span>
                                </a>
                                <!-- VÙNG HIỂN THỊ GIỎ HÀNG -->
                                <div id="cartDropdown" style="display: none; position: absolute; right: 0;
                                top: 100%; background: white; border: 1px solid #ccc;
                                width: 200px; max-height: 400px; overflow-y: auto; z-index: 9999; padding: 10px;">
                                    <strong>Sản phẩm trong giỏ:</strong>
                                    <ul id="cartItemsList" style="list-style: none; padding-left: 0;"></ul>
                                    <hr />
                                </div>
                            </li>
                            <li>
                                <a href=shopcart.html>
                                    <i class="fa fa-heart"></i>
                                    <span>
                                        Yêu thích(<span class=cartitems>0</span>)
                                    </span>
                                </a>
                            </li>

                        </ul>
                    </div>
                </div>
            </div>
            <div class="header-lower clearfix">
                <div class=container>
                    <div class=row>
                        <h1 class=logo><a href="/"><img src=~/images/logo.png alt=image></a></h1>
                        <div class=menubar>
                            <nav class=navbar>
                                <div class=nav-wrapper>
                                    <div class=navbar-header>
                                        <button type=button class=navbar-toggle>
                                            <span class=sr-only>Toggle navigation</span>
                                            <span class=icon-bar></span>
                                        </button>
                                    </div>
                                    <div class=nav-menu>
                                        <ul class="nav navbar-nav menu-bar">
                                            <li>
                                                <a href="/" class="@Html.IsActive("Home", "Index")">
                                                    Trang chủ <span></span> <span></span>
                                                    <span></span> <span></span>
                                                </a>
                                            </li>
                                            <li>
                                                <a asp-action="Index" asp-controller="About" class="@Html.IsActive("About", "Index")">
                                                    Chúng tôi <span></span> <span></span> <span></span>
                                                    <span></span>
                                                </a>
                                            </li>
                                            <li>
                                                <a asp-action="Index" asp-controller="Book" class="@Html.IsActiveParent("Book")">
                                                    Đặt sân <span></span> <span></span>
                                                    <span></span> <span></span>
                                                </a>
                                            </li>
                                            <li>
                                                <a asp-action="Index" asp-controller="Shop" class="@Html.IsActiveParent("Shop")">
                                                    Cửa hàng <span></span> <span></span> <span></span>
                                                    <span></span>
                                                </a>
                                            </li>
                                            <li>
                                                <a asp-action="Index" asp-controller="Contact" class="@Html.IsActive("Contact", "Index")">
                                                    Liên hệ <span></span> <span></span> <span></span>
                                                    <span></span>
                                                </a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </nav>
                        </div>
                    </div>
                </div>
            </div>
        </header>
        @RenderBody()
        <footer class=footer-type01>
            <div class=container>
                <div class=row>
                    <ul class=footer-widget style="margin-right: 50px;">
                        <li class=widget-about style="width:320px">
                            <h4 class=footerheading>về <span>soccer club</span></h4>
                            <p>
                                Là một website về bóng đá, cung cấp dịch vụ đặt sân, tìm đối thủ,
                                bán thiết bị thể thao chất lượng cao. Kết nối cộng đồng yêu bóng đá và tạo ra
                                những trận đấu đáng nhớ.
                            </p>
                            <p>
                                <span class=uppercaseheading>địa chỉ:</span> Khu Công nghệ cao Hòa Lạc,
                                Thạch Thất, Hà Nội
                            </p>
                            <p><span class=uppercaseheading>hotline:</span> <span class=red>0378313640</span></p>
                            <p><span class=uppercaseheading>email:</span> <span class=red>notifi.contact@gmail.com</span></p>
                        </li>

                        <li class=widget-news style="width:290px">
                            <h4 class=footerheading>dịch vụ <span>đặt sân</span></h4>
                            <ul class=widget_productdetails>
                                <li><a href="#">Sân 7 người</a></li>
                            </ul>
                        </li>

                        <li class=widget-product>
                            <h4 class=footerheading>Đặt Sân Thể Thao & <span>Mua Sắm</span></h4>
                            <ul class=widget_productdetails>
                                <li>
                                    <a asp-action="Index" asp-controller="Book" class="@Html.IsActiveParent("Book")">
                                        Đặt sân
                                    </a>
                                </li>
                                <li>
                                    <a asp-action="Index" asp-controller="Shop" class="@Html.IsActiveParent("Shop")">
                                        Cửa hàng
                                    </a>
                                </li>
                            </ul>
                        </li>
                    </ul>

                    <!-- Thêm phần mạng xã hội và thông tin bổ sung -->
                    <div class="footer-bottom">
                        <div class="social-links">
                            <h5>
                                Kết nối với chúng tôi
                                <a href="https://www.facebook.com/profile.php?id=61576849465856" target="_blank"><i class="fa fa-facebook"></i></a>
                            </h5>
                        </div>
                        <div class="quick-info">
                            <p><strong>Giờ hoạt động:</strong> 6:00 - 22:00 hàng ngày</p>
                            <p><strong>Hỗ trợ 24/7:</strong> Chat online hoặc gọi hotline</p>
                        </div>
                    </div>
                </div>
            </div>
        </footer>
    </div>
    <script src=~/js/vendor/vendor.js></script>
    <script src=~/js/main.js></script>
    @await RenderSectionAsync("Scripts", required: false)
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            // Xử lý dropdown giỏ hàng
            const toggleCart = document.getElementById('toggleCart');
            const dropdown = document.getElementById('cartDropdown');

            function updateCart() {
                fetch('https://api.soccer.soccertips.org/api/cart/checkout', {
                    method: 'GET',
                    credentials: 'include'

                })
                .then(res => {
                    console.log('Trạng thái phản hồi:', res.status);
                    if (!res.ok) throw new Error(`Lỗi HTTP: ${res.status}`);
                    return res.json();
                })
                .then(data => {
                    console.log('Dữ liệu giỏ hàng:', data);
                    const cartCount = data.reduce((total, item) => total + (item.quantity || 0), 0);
                    document.querySelectorAll('.cartitems').forEach(el => {
                        el.textContent = cartCount;
                    });

                    const list = document.getElementById('cartItemsList');
                    list.innerHTML = '';
                    if (data.length === 0) {
                        list.innerHTML = '<li>Không có sản phẩm nào trong giỏ.</li>';
                    } else {
                        let totalCartPrice = 0;

                        data.forEach(item => {
                            const productName = item.productName || 'Sản phẩm ID: ' + (item.productId || 'N/A');
                            const quantity = item.quantity || 0;
                            const unitPrice = item.unitPrice || 0;
                            const imageUrl = item.imageUrl || '';

                            const totalPrice = unitPrice * quantity;
                            totalCartPrice += totalPrice;

                            const li = document.createElement('li');

                            li.innerHTML = `
                                <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                    ${imageUrl ? `<img src="${imageUrl}" alt="${productName}" style="width: 40px; height: 40px; object-fit: cover;" />` : ''}
                                    <div style="flex: 1;">
                                        <span>${productName}</span>
                                        <div>Số lượng: ${quantity}</div>
                                        <div>Giá tổng: ${totalPrice.toLocaleString('vi-VN')}đ</div>
                                    </div>
                                </div>`;

                            list.appendChild(li);
                        });

                        const totalLi = document.createElement('li');
                        totalLi.innerHTML = `<strong>Tổng giá giỏ hàng: ${totalCartPrice.toLocaleString('vi-VN')}đ</strong>
                                    <a href="/Cart/Checkout" class="btn btn-primary btn-sm">Xem chi tiết</a>`;
                        list.appendChild(totalLi);
                    }
                })
                .catch(err => {
                    console.error("Lỗi lấy giỏ hàng:", err);
                    document.getElementById('cartItemsList').innerHTML = '<li>Lỗi khi tải giỏ hàng.</li>';
                });
            }

            if (toggleCart) {
                toggleCart.addEventListener('click', function (e) {
                    e.preventDefault();
                    const visible = dropdown.style.display === 'block';
                    dropdown.style.display = visible ? 'none' : 'block';
                    if (!visible) updateCart();
                });
            }

            // Xử lý dropdown user account
            const userAccountDropdown = document.getElementById('userAccountDropdown');
            const userAccountToggle = document.getElementById('userAccountToggle');

            if (userAccountToggle) {
                userAccountToggle.addEventListener('click', function (e) {
                    e.preventDefault();
                    userAccountDropdown.classList.toggle('active');
                });
            }

          async function checkLoginStatus() {
                try {
                    const response = await fetch('https://api.soccer.soccertips.org/api/Auth/get-token', {
                        method: 'GET',
                        credentials: 'include' // Gửi cookie session
                    });

                    const authLinks = document.getElementById('authLinks');
                    if (response.ok) {
                        const data = await response.json();
                        if (data.token) {
                            // Đã đăng nhập, hiển thị dropdown tài khoản
                            const userName = data.userName || 'Người dùng';
                            authLinks.innerHTML = `

                                <li style="margin-left: 20px;">
                                    <div class="user-account-dropdown" id="userAccountDropdown">
                                        <button class="user-account-toggle" id="userAccountToggle">
                                            <div class="user-avatar">${userName.substring(0, 1).toUpperCase()}</div>
                                            <span>Xin chào, ${userName}</span>
                                            <span class="dropdown-arrow">▼</span>
                                        </button>
                                        <div class="user-dropdown-menu">
                                            <div class="user-dropdown-header">
                                                <div class="user-name">${userName}</div>
                                                <div class="user-role">Thành viên</div>
                                            </div>
                                            <ul>
                                                <li><a href="/Profile"><i class="fa fa-user"></i>Xem thông tin tài khoản</a></li>
                                                <li class="logout-link"><a href="#" id="logoutLink"><i class="fa fa-sign-out"></i>Đăng xuất</a></li>
                                            </ul>
                                        </div>
                                    </div>
                                </li>`;
                                 // Thiết lập event listener NGAY SAU KHI tạo HTML
                const userAccountDropdown = document.getElementById('userAccountDropdown');
                const userAccountToggle = document.getElementById('userAccountToggle');

                if (userAccountToggle) {
                    userAccountToggle.addEventListener('click', function (e) {
                        e.preventDefault();
                        userAccountDropdown.classList.toggle('active');
                    });
                }
                        } else {
                            // Chưa đăng nhập, hiển thị liên kết đăng nhập và đăng ký
                            authLinks.innerHTML = `
                                <li><a href="/Auth/Login">Đăng nhập</a></li>
                                <li><a href="/Auth/Register">Đăng ký</a></li>`  ;

                        }
                    } else {
                        authLinks.innerHTML = `
                            <li><a href="/Auth/Login">Đăng nhập</a></li>
                            <li><a href="/Auth/Register">Đăng ký</a></li>
                          `;
                    }
                } catch (error) {
                    console.error('Error checking login status:', error);
                    const authLinks = document.getElementById('authLinks');
                    authLinks.innerHTML = `
                        <li><a href="/Auth/Login">Đăng nhập</a></li>
                        <li><a href="/Auth/Register">Đăng ký</a></li>
                   `;
                }
            }

            // Gọi hàm kiểm tra khi trang tải
            checkLoginStatus();

            // Xử lý đăng xuất
        // Xử lý đăng xuất với animation
        document.addEventListener('click', function (event) {
            if (event.target && event.target.id === 'logoutLink') {
                event.preventDefault();

                const logoutLink = event.target;
                const dropdown = document.getElementById('userAccountDropdown');
                const userDropdownMenu = dropdown.querySelector('.user-dropdown-menu');

                // Thêm class animation cho button
                logoutLink.classList.add('logout-button-animate', 'clicked');

                // Thêm loading spinner
                const originalText = logoutLink.innerHTML;
                logoutLink.innerHTML = originalText + '<span class="logout-loading"></span>';

                // Thêm animation cho dropdown
                dropdown.classList.add('logout-animation', 'active');

                // Disable button để tránh click nhiều lần
                logoutLink.style.pointerEvents = 'none';

                fetch('https://api.soccer.soccertips.org/api/Auth/logout', {
                    method: 'POST',
                    credentials: 'include',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                })
                .then(async response => {
                    const contentType = response.headers.get('content-type');

                    if (response.ok) {
                        // Success animation
                        logoutLink.classList.remove('clicked');
                        logoutLink.classList.add('logout-success');

                        // Thay đổi text thành công
                        logoutLink.innerHTML = '<i class="fa fa-check"></i>Đã đăng xuất';

                        setTimeout(() => {
                            // Animation đóng dropdown
                            userDropdownMenu.classList.add('closing');

                            setTimeout(() => {
                                // Fade out toàn bộ dropdown
                                dropdown.classList.add('logout-fade');

                                setTimeout(() => {
                                    // Cập nhật giao diện
                                    checkLoginStatus();
                                }, 400);
                            }, 300);
                        }, 800);

                        if (contentType && contentType.includes('application/json')) {
                            const data = await response.json();
                            console.log('Đăng xuất thành công:', data.message);
                        } else {
                            console.log('Đăng xuất thành công');
                        }
                    } else {
                        // Error handling
                        logoutLink.classList.remove('clicked');
                        logoutLink.innerHTML = originalText;
                        logoutLink.style.pointerEvents = 'auto';

                        if (contentType && contentType.includes('application/json')) {
                            const errorData = await response.json();
                            console.error('Lỗi đăng xuất:', errorData.message);
                        } else {
                            console.error('Lỗi đăng xuất:', response.statusText);
                        }
                    }
                })
                .catch(error => {
                    console.error('Logout error:', error);
                    // Reset button state
                    logoutLink.classList.remove('clicked');
                    logoutLink.innerHTML = originalText;
                    logoutLink.style.pointerEvents = 'auto';
                    // Vẫn cập nhật giao diện trong trường hợp lỗi network
                    checkLoginStatus();
                });
            }
        });

            updateCart();
        });
    </script>
</body>
</html>